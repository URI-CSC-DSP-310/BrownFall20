---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.12
    jupytext_version: 1.6.0
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Class 11: Cleaning Data

```{code-cell} ipython3
import pandas as pd
```

```{code-cell} ipython3
# %load http://drsmb.co/310
data_url = 'https://github.com/rhodyprog4ds/inclass-data/raw/main/ca_dds_summary.xlsx'
```

```{code-cell} ipython3
ca_dds_df = pd.read_excel(data_url, header=list(range(3)))
ca_dds_df
```

```{code-cell} ipython3
print(ca_dds_df)
```
we can do df.index to look at what the index is in our dataframe
```{code-cell} ipython3
ca_dds_df.index
```
columns are tuple values. We can index to the first column as below. As we can see by running this code, this column has three names initially. 
```{code-cell} ipython3
ca_dds_df.columns[0]
```
By the following code we can assign the first column as the index of original dataframe. If we assign "False" to the "inplace", it will make the changes in a new dataframe.
```{code-cell} ipython3
ca_dds_df.set_index(ca_dds_df.columns[0],inplace=True)
```
The updated dataframe looks like below. We still have the name of index inappropriate and aslo there are empty rows. 
```{code-cell} ipython3
ca_dds_df
```
we can drop rows with "all" or "any"  NaN values. We would choose "all", since if we choose "all" we will loose many rows here and we do not want it.
```{code-cell} ipython3
ca_dds_df.dropna(how='all',inplace=True)
```
We can view the index by the following code. Remember that this is not a regular column anymore since we assigned it to be our dataframe index.
```{code-cell} ipython3
ca_dds_df.index
```

```{code-cell} ipython3
ca_dds_df.index.rename('Age Cohort',inplace=True)
```

```{code-cell} ipython3
ca_dds_df.T.unstack(level= [0,1]).T.reset_index()
```

```{code-cell} ipython3
ca_dds_clean = ca_dds_df.T.unstack(level= [0,1]).T.reset_index()
ca_dds_clean.head()
```

```{code-cell} ipython3
ca_dds_clean.columns[1] = 'Race'
```

```{code-cell} ipython3
type(ca_dds_clean.columns)
```

```{code-cell} ipython3
ca_dds_clean.rename(columns= {'level_1':'Race', 'level_2':'Gender'},inplace=True)
ca_dds_clean.head()
```

```{code-cell} ipython3
ca_dds_clean['count'][0]
```

```{code-cell} ipython3
ca_dds_clean.Gender[0]
```

```{code-cell} ipython3
ca_dds_clean.Gender[0].lower()
```

```{code-cell} ipython3
clean_cols = {c:c.lower().replace(' ','_') for c in ca_dds_clean.columns}
ca_dds_clean.rename(columns=clean_cols,inplace=True)
ca_dds_clean.head()
```

```{code-cell} ipython3
ca_dds_clean.fillna('*')
```

```{code-cell} ipython3

```
