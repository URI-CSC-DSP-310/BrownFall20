
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Class 12: Constructing Datasets from Multiple Sources &#8212; Programming for Data Science at URI Fall 2020</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Class 13: Data from multiple sources and Databases" href="2020-10-07.html" />
    <link rel="prev" title="Class 11: Cleaning Data" href="2020-10-02.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Programming for Data Science at URI Fall 2020</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to Programming for Data Science
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../syllabus/index.html">
   Syllabus
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../syllabus/about-course.html">
     About
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../syllabus/tools.html">
     Tools and Resources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../syllabus/grading.html">
     Grading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../syllabus/course_map.html">
     Learning Objective, Schedule, and Rubric
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../syllabus/uri_resources.html">
     Support
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../syllabus/uri_statements.html">
     Policies
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="index.html">
   Class Notes
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="2020-09-11.html">
     Class 2: intro to notebooks and python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-09-14.html">
     Class 3: Welcome to Week 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-09-16.html">
     Class 4: Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-09-18.html">
     Class 5: Accessing Data, continued
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-09-21.html">
     Class 6: Exploratory Data Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-09-23.html">
     Class 7: Visualization for EDA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-09-25.html">
     Class 8: Visualization and Starting to Clean Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-09-28.html">
     Class 9: Preparing Data For Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-09-30.html">
     Class 10: Cleaning review and Ray Summit Keynotes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-02.html">
     Class 11: Cleaning Data
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Class 12: Constructing Datasets from Multiple Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-07.html">
     Class 13: Data from multiple sources and Databases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-12.html">
     Class 15: Intro to ML &amp; Modeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-14.html">
     Class 16: Naive Bayes Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-16.html">
     Class 17: Evaluating Classification and Midsemester Feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-19.html">
     Class 18: Mid Semester Checkin, Git, &amp; How GNB makes decisions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-21.html">
     Class 19: Decision Trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-23.html">
     Class 20: Decision Trees and Cross Validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-26.html">
     Class 21: Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-28.html">
     Class 22: More Regression, More Evaluation and LASSO
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-10-30.html">
     Class 23: Interpretting Regression Evaluations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-11-02.html">
     Class 24: Clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-11-04.html">
     Class 25: Evaluating Clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-11-06.html">
     Class 26: More Clustering Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-11-09.html">
     Class 27: Model Optimization- Choosing K
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-11-13.html">
     Class 28: SVM &amp; Model Optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-11-16.html">
     Class 29: Choosing a Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-11-18.html">
     Class 30: Learning Curves, Validation Curves
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-11-20.html">
     Class 31: Confidence Intervals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2020-11-23.html">
     Class 31: Intro to NLP
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../assignments/index.html">
   Assignments
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/01-python-syllabus.html">
     Assignment 1: Portfolio Setup, Data Science, and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/02-python-access.html">
     Assignment 2: Practicing Python and Accessing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/03-exploratory.html">
     Assignment 3: Exploratory Data Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/04-prepare.html">
     Assignment 4: Preparing Data for Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/05-construct.html">
     Assignment 5: Constructing Datasets and Using Databases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/06-naive-bayes.html">
     Assignment 6: Naive Bayes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/07-decision-tree.html">
     Assignment 7: Decision Trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/08-regression.html">
     Assignment 8: Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/09-clustering.html">
     Assignment 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/10-optimization.html">
     Assignment 10: Optimizing Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/11-model-selection.html">
     Assignment 11: Model Comparison
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/12-fake-news.html">
     Assignment 12: Fake News
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../portfolio/index.html">
   Portfolio
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../portfolio/formatting.html">
     Formatting Tips
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../portfolio/reflective.html">
     Reflective Prompts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../portfolio/analyses.html">
     Analysis Prompts
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../faq/index.html">
   FAQ
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../faq/syllabus.html">
     Syllabus FAQ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../faq/github.html">
     GitHub FAQ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../faq/debugging.html">
     Common Debugging Issues
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../resources/index.html">
   Resources
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tips.html">
     General Tips and Resources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/python.html">
     References on Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/datasets.html">
     Data Sources
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/notes/2020-10-05.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notes/2020-10-05.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/rhodyprog4ds/BrownFall20//issues/new?title=Issue%20on%20page%20%2Fnotes/2020-10-05.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/rhodyprog4ds/BrownFall20/edit/main/notes/2020-10-05.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/rhodyprog4ds/BrownFall20/main?urlpath=tree/notes/2020-10-05.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stacking-dataframes">
   Stacking DataFrames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-data-frames">
   Merging Data Frames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-combine-the-same-data-for-different-outcomes">
   How to combine the same data for different outcomes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#try-it-yourself">
   Try it yourself
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="class-12-constructing-datasets-from-multiple-sources">
<h1>Class 12: Constructing Datasets from Multiple Sources<a class="headerlink" href="#class-12-constructing-datasets-from-multiple-sources" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Sometimes we use data from multiple sources. For example data may be provided across a bunch of tables and we want to put them together. Or we may want to build our own dataset to answer the questions that we want to ask.
For example we have a dataset of drivers who have been pulled over by the police, and need to compare distribution of them between day and night times. If we only have time of being pulled over without mentioning day/night, we can use another dataset including time of sunset for every day and build our own dataset out of these two dataset to find the answer.
Later we will also learn about getting data out of databses with some small database operations through SQLite and some python libararies.</p>
<p>To use relative paths as in class (<code class="docutils literal notranslate"><span class="pre">data/2018-games.csv</span></code>) instead of a full url <code class="docutils literal notranslate"><span class="pre">https://raw.githubusercontent.com/rhodyprog4ds/inclass-data/main/2018-games.csv</span></code>, download data from <a class="reference external" href="https://github.com/rhodyprog4ds/inclass-data">this GitHub repo</a> by clicking on the green code button and choosing .zip. Then unzip the data and save it in a data folder in the same folder as the notebook. For the class notes, the urls make it so that the notebook can run without having to store the data in another place.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games_df18</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/rhodyprog4ds/inclass-data/main/2018-games.csv&#39;</span><span class="p">)</span>
<span class="n">games_df19</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/rhodyprog4ds/inclass-data/main/2019-games.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<!-- annotate: Stacking DataFrames -->
</div>
<div class="section" id="stacking-dataframes">
<h2>Stacking DataFrames<a class="headerlink" href="#stacking-dataframes" title="Permalink to this headline">¶</a></h2>
<p>Let’s look at the first couple of rows to see how the configuration of data is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games_df18</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>GAME_DATE_EST</th>
      <th>GAME_ID</th>
      <th>GAME_STATUS_TEXT</th>
      <th>HOME_TEAM_ID</th>
      <th>VISITOR_TEAM_ID</th>
      <th>SEASON</th>
      <th>TEAM_ID_home</th>
      <th>PTS_home</th>
      <th>FG_PCT_home</th>
      <th>...</th>
      <th>AST_home</th>
      <th>REB_home</th>
      <th>TEAM_ID_away</th>
      <th>PTS_away</th>
      <th>FG_PCT_away</th>
      <th>FT_PCT_away</th>
      <th>FG3_PCT_away</th>
      <th>AST_away</th>
      <th>REB_away</th>
      <th>HOME_TEAM_WINS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16196</td>
      <td>2019-06-13</td>
      <td>41800406</td>
      <td>Final</td>
      <td>1610612744</td>
      <td>1610612761</td>
      <td>2018</td>
      <td>1610612744</td>
      <td>110.0</td>
      <td>0.488</td>
      <td>...</td>
      <td>28.0</td>
      <td>42.0</td>
      <td>1610612761</td>
      <td>114.0</td>
      <td>0.476</td>
      <td>0.793</td>
      <td>0.394</td>
      <td>25.0</td>
      <td>39.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16197</td>
      <td>2019-06-10</td>
      <td>41800405</td>
      <td>Final</td>
      <td>1610612761</td>
      <td>1610612744</td>
      <td>2018</td>
      <td>1610612761</td>
      <td>105.0</td>
      <td>0.447</td>
      <td>...</td>
      <td>19.0</td>
      <td>43.0</td>
      <td>1610612744</td>
      <td>106.0</td>
      <td>0.463</td>
      <td>0.714</td>
      <td>0.476</td>
      <td>27.0</td>
      <td>37.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 22 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games_df19</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>GAME_DATE_EST</th>
      <th>GAME_ID</th>
      <th>GAME_STATUS_TEXT</th>
      <th>HOME_TEAM_ID</th>
      <th>VISITOR_TEAM_ID</th>
      <th>SEASON</th>
      <th>TEAM_ID_home</th>
      <th>PTS_home</th>
      <th>FG_PCT_home</th>
      <th>...</th>
      <th>AST_home</th>
      <th>REB_home</th>
      <th>TEAM_ID_away</th>
      <th>PTS_away</th>
      <th>FG_PCT_away</th>
      <th>FT_PCT_away</th>
      <th>FG3_PCT_away</th>
      <th>AST_away</th>
      <th>REB_away</th>
      <th>HOME_TEAM_WINS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2020-03-01</td>
      <td>21900895</td>
      <td>Final</td>
      <td>1610612766</td>
      <td>1610612749</td>
      <td>2019</td>
      <td>1610612766</td>
      <td>85.0</td>
      <td>0.354</td>
      <td>...</td>
      <td>22.0</td>
      <td>47.0</td>
      <td>1610612749</td>
      <td>93.0</td>
      <td>0.402</td>
      <td>0.762</td>
      <td>0.226</td>
      <td>20.0</td>
      <td>61.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2020-03-01</td>
      <td>21900896</td>
      <td>Final</td>
      <td>1610612750</td>
      <td>1610612742</td>
      <td>2019</td>
      <td>1610612750</td>
      <td>91.0</td>
      <td>0.364</td>
      <td>...</td>
      <td>19.0</td>
      <td>57.0</td>
      <td>1610612742</td>
      <td>111.0</td>
      <td>0.468</td>
      <td>0.632</td>
      <td>0.275</td>
      <td>28.0</td>
      <td>56.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 22 columns</p>
</div></div></div>
</div>
<p>As we can see, both datasets have the same columns, and just for two different years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games_df18</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1378, 22)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games_df19</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(965, 22)
</pre></div>
</div>
</div>
</div>
<p>Let’s concatenate two dataframes to make one dataframe out of them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">games_df18</span><span class="p">,</span><span class="n">games_df19</span><span class="p">])</span>
<span class="n">games_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2343, 22)
</pre></div>
</div>
</div>
</div>
<p>As we can see rows are added up but we have the same numbe of rcolums.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Unnamed: 0&#39;, &#39;GAME_DATE_EST&#39;, &#39;GAME_ID&#39;, &#39;GAME_STATUS_TEXT&#39;,
       &#39;HOME_TEAM_ID&#39;, &#39;VISITOR_TEAM_ID&#39;, &#39;SEASON&#39;, &#39;TEAM_ID_home&#39;, &#39;PTS_home&#39;,
       &#39;FG_PCT_home&#39;, &#39;FT_PCT_home&#39;, &#39;FG3_PCT_home&#39;, &#39;AST_home&#39;, &#39;REB_home&#39;,
       &#39;TEAM_ID_away&#39;, &#39;PTS_away&#39;, &#39;FG_PCT_away&#39;, &#39;FT_PCT_away&#39;,
       &#39;FG3_PCT_away&#39;, &#39;AST_away&#39;, &#39;REB_away&#39;, &#39;HOME_TEAM_WINS&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Let’s drop the column we do not need.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
<span class="n">games_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GAME_DATE_EST</th>
      <th>GAME_ID</th>
      <th>GAME_STATUS_TEXT</th>
      <th>HOME_TEAM_ID</th>
      <th>VISITOR_TEAM_ID</th>
      <th>SEASON</th>
      <th>TEAM_ID_home</th>
      <th>PTS_home</th>
      <th>FG_PCT_home</th>
      <th>FT_PCT_home</th>
      <th>...</th>
      <th>AST_home</th>
      <th>REB_home</th>
      <th>TEAM_ID_away</th>
      <th>PTS_away</th>
      <th>FG_PCT_away</th>
      <th>FT_PCT_away</th>
      <th>FG3_PCT_away</th>
      <th>AST_away</th>
      <th>REB_away</th>
      <th>HOME_TEAM_WINS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-06-13</td>
      <td>41800406</td>
      <td>Final</td>
      <td>1610612744</td>
      <td>1610612761</td>
      <td>2018</td>
      <td>1610612744</td>
      <td>110.0</td>
      <td>0.488</td>
      <td>0.700</td>
      <td>...</td>
      <td>28.0</td>
      <td>42.0</td>
      <td>1610612761</td>
      <td>114.0</td>
      <td>0.476</td>
      <td>0.793</td>
      <td>0.394</td>
      <td>25.0</td>
      <td>39.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-06-10</td>
      <td>41800405</td>
      <td>Final</td>
      <td>1610612761</td>
      <td>1610612744</td>
      <td>2018</td>
      <td>1610612761</td>
      <td>105.0</td>
      <td>0.447</td>
      <td>0.778</td>
      <td>...</td>
      <td>19.0</td>
      <td>43.0</td>
      <td>1610612744</td>
      <td>106.0</td>
      <td>0.463</td>
      <td>0.714</td>
      <td>0.476</td>
      <td>27.0</td>
      <td>37.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 21 columns</p>
</div></div></div>
</div>
<!-- annotate: Merging Data Frames -->
</div>
<div class="section" id="merging-data-frames">
<h2>Merging Data Frames<a class="headerlink" href="#merging-data-frames" title="Permalink to this headline">¶</a></h2>
<p>Now we read another dataset which some of its columns are the same as dataframe “games_df” and some are different.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">teams_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/rhodyprog4ds/inclass-data/main/teams.csv&#39;</span><span class="p">)</span>
<span class="n">teams_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LEAGUE_ID</th>
      <th>TEAM_ID</th>
      <th>MIN_YEAR</th>
      <th>MAX_YEAR</th>
      <th>ABBREVIATION</th>
      <th>NICKNAME</th>
      <th>YEARFOUNDED</th>
      <th>CITY</th>
      <th>ARENA</th>
      <th>ARENACAPACITY</th>
      <th>OWNER</th>
      <th>GENERALMANAGER</th>
      <th>HEADCOACH</th>
      <th>DLEAGUEAFFILIATION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1610612737</td>
      <td>1949</td>
      <td>2019</td>
      <td>ATL</td>
      <td>Hawks</td>
      <td>1949</td>
      <td>Atlanta</td>
      <td>State Farm Arena</td>
      <td>18729.0</td>
      <td>Tony Ressler</td>
      <td>Travis Schlenk</td>
      <td>Lloyd Pierce</td>
      <td>Erie Bayhawks</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1610612738</td>
      <td>1946</td>
      <td>2019</td>
      <td>BOS</td>
      <td>Celtics</td>
      <td>1946</td>
      <td>Boston</td>
      <td>TD Garden</td>
      <td>18624.0</td>
      <td>Wyc Grousbeck</td>
      <td>Danny Ainge</td>
      <td>Brad Stevens</td>
      <td>Maine Red Claws</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We use left_on=’TEAM_ID’ and right_on = ‘HOME_TEAM_ID’ to match two dataframes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merge1_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">teams_df</span><span class="p">,</span><span class="n">games_df</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;TEAM_ID&#39;</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s1">&#39;HOME_TEAM_ID&#39;</span><span class="p">)</span>
<span class="n">merge1_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LEAGUE_ID</th>
      <th>TEAM_ID</th>
      <th>MIN_YEAR</th>
      <th>MAX_YEAR</th>
      <th>ABBREVIATION</th>
      <th>NICKNAME</th>
      <th>YEARFOUNDED</th>
      <th>CITY</th>
      <th>ARENA</th>
      <th>ARENACAPACITY</th>
      <th>...</th>
      <th>AST_home</th>
      <th>REB_home</th>
      <th>TEAM_ID_away</th>
      <th>PTS_away</th>
      <th>FG_PCT_away</th>
      <th>FT_PCT_away</th>
      <th>FG3_PCT_away</th>
      <th>AST_away</th>
      <th>REB_away</th>
      <th>HOME_TEAM_WINS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1610612737</td>
      <td>1949</td>
      <td>2019</td>
      <td>ATL</td>
      <td>Hawks</td>
      <td>1949</td>
      <td>Atlanta</td>
      <td>State Farm Arena</td>
      <td>18729.0</td>
      <td>...</td>
      <td>29.0</td>
      <td>61.0</td>
      <td>1610612754</td>
      <td>135.0</td>
      <td>0.459</td>
      <td>0.846</td>
      <td>0.400</td>
      <td>22.0</td>
      <td>43.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1610612737</td>
      <td>1949</td>
      <td>2019</td>
      <td>ATL</td>
      <td>Hawks</td>
      <td>1949</td>
      <td>Atlanta</td>
      <td>State Farm Arena</td>
      <td>18729.0</td>
      <td>...</td>
      <td>29.0</td>
      <td>44.0</td>
      <td>1610612755</td>
      <td>122.0</td>
      <td>0.459</td>
      <td>0.579</td>
      <td>0.323</td>
      <td>27.0</td>
      <td>57.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 35 columns</p>
</div></div></div>
</div>
<p>We want information for each game and append the team info onto that. So, lets try another settings in our mergging.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merge1_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2343, 35)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merge2_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">teams_df</span><span class="p">,</span> <span class="n">games_df</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;TEAM_ID&#39;</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s1">&#39;HOME_TEAM_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merge2_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LEAGUE_ID</th>
      <th>TEAM_ID</th>
      <th>MIN_YEAR</th>
      <th>MAX_YEAR</th>
      <th>ABBREVIATION</th>
      <th>NICKNAME</th>
      <th>YEARFOUNDED</th>
      <th>CITY</th>
      <th>ARENA</th>
      <th>ARENACAPACITY</th>
      <th>...</th>
      <th>AST_home</th>
      <th>REB_home</th>
      <th>TEAM_ID_away</th>
      <th>PTS_away</th>
      <th>FG_PCT_away</th>
      <th>FT_PCT_away</th>
      <th>FG3_PCT_away</th>
      <th>AST_away</th>
      <th>REB_away</th>
      <th>HOME_TEAM_WINS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1610612737</td>
      <td>1949</td>
      <td>2019</td>
      <td>ATL</td>
      <td>Hawks</td>
      <td>1949</td>
      <td>Atlanta</td>
      <td>State Farm Arena</td>
      <td>18729.0</td>
      <td>...</td>
      <td>29.0</td>
      <td>61.0</td>
      <td>1610612754</td>
      <td>135.0</td>
      <td>0.459</td>
      <td>0.846</td>
      <td>0.400</td>
      <td>22.0</td>
      <td>43.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1610612737</td>
      <td>1949</td>
      <td>2019</td>
      <td>ATL</td>
      <td>Hawks</td>
      <td>1949</td>
      <td>Atlanta</td>
      <td>State Farm Arena</td>
      <td>18729.0</td>
      <td>...</td>
      <td>29.0</td>
      <td>44.0</td>
      <td>1610612755</td>
      <td>122.0</td>
      <td>0.459</td>
      <td>0.579</td>
      <td>0.323</td>
      <td>27.0</td>
      <td>57.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 35 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merge2_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2343, 35)
</pre></div>
</div>
</div>
</div>
<p>We can group by “ARENA” and then look at the “mean” statistics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merge1_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ARENA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LEAGUE_ID</th>
      <th>TEAM_ID</th>
      <th>MIN_YEAR</th>
      <th>MAX_YEAR</th>
      <th>YEARFOUNDED</th>
      <th>ARENACAPACITY</th>
      <th>GAME_ID</th>
      <th>HOME_TEAM_ID</th>
      <th>VISITOR_TEAM_ID</th>
      <th>SEASON</th>
      <th>...</th>
      <th>AST_home</th>
      <th>REB_home</th>
      <th>TEAM_ID_away</th>
      <th>PTS_away</th>
      <th>FG_PCT_away</th>
      <th>FT_PCT_away</th>
      <th>FG3_PCT_away</th>
      <th>AST_away</th>
      <th>REB_away</th>
      <th>HOME_TEAM_WINS</th>
    </tr>
    <tr>
      <th>ARENA</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AT&amp;T Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1976.000000</td>
      <td>2019.0</td>
      <td>1976.000000</td>
      <td>18694.0</td>
      <td>2.184021e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.397436</td>
      <td>...</td>
      <td>25.141026</td>
      <td>45.782051</td>
      <td>1.610613e+09</td>
      <td>108.448718</td>
      <td>0.449333</td>
      <td>0.770808</td>
      <td>0.348231</td>
      <td>23.987179</td>
      <td>43.833333</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>American Airlines Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1980.000000</td>
      <td>2019.0</td>
      <td>1980.000000</td>
      <td>19200.0</td>
      <td>2.130985e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.426667</td>
      <td>...</td>
      <td>23.920000</td>
      <td>46.093333</td>
      <td>1.610613e+09</td>
      <td>108.960000</td>
      <td>0.456093</td>
      <td>0.777320</td>
      <td>0.347707</td>
      <td>22.960000</td>
      <td>43.720000</td>
      <td>0.546667</td>
    </tr>
    <tr>
      <th>AmericanAirlines Arena</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1988.000000</td>
      <td>2019.0</td>
      <td>1988.000000</td>
      <td>19600.0</td>
      <td>2.105314e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.421053</td>
      <td>...</td>
      <td>25.039474</td>
      <td>46.276316</td>
      <td>1.610613e+09</td>
      <td>106.618421</td>
      <td>0.442684</td>
      <td>0.771987</td>
      <td>0.344250</td>
      <td>23.157895</td>
      <td>42.131579</td>
      <td>0.644737</td>
    </tr>
    <tr>
      <th>Amway Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1989.000000</td>
      <td>2019.0</td>
      <td>1989.000000</td>
      <td>0.0</td>
      <td>2.171458e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.423077</td>
      <td>...</td>
      <td>24.525641</td>
      <td>45.935897</td>
      <td>1.610613e+09</td>
      <td>105.538462</td>
      <td>0.454372</td>
      <td>0.772487</td>
      <td>0.359962</td>
      <td>22.987179</td>
      <td>44.769231</td>
      <td>0.538462</td>
    </tr>
    <tr>
      <th>Bankers Life Fieldhouse</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1976.000000</td>
      <td>2019.0</td>
      <td>1976.000000</td>
      <td>18345.0</td>
      <td>2.197454e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.441558</td>
      <td>...</td>
      <td>26.363636</td>
      <td>44.597403</td>
      <td>1.610613e+09</td>
      <td>103.051948</td>
      <td>0.435494</td>
      <td>0.761805</td>
      <td>0.329442</td>
      <td>23.272727</td>
      <td>44.662338</td>
      <td>0.675325</td>
    </tr>
    <tr>
      <th>Barclays Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1976.000000</td>
      <td>2019.0</td>
      <td>1976.000000</td>
      <td>NaN</td>
      <td>2.197516e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.413333</td>
      <td>...</td>
      <td>23.880000</td>
      <td>48.000000</td>
      <td>1.610613e+09</td>
      <td>110.293333</td>
      <td>0.448133</td>
      <td>0.773533</td>
      <td>0.338547</td>
      <td>22.640000</td>
      <td>45.000000</td>
      <td>0.533333</td>
    </tr>
    <tr>
      <th>Capital One Arena</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1961.000000</td>
      <td>2019.0</td>
      <td>1961.000000</td>
      <td>20647.0</td>
      <td>2.130190e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.418919</td>
      <td>...</td>
      <td>25.891892</td>
      <td>43.932432</td>
      <td>1.610613e+09</td>
      <td>115.310811</td>
      <td>0.472041</td>
      <td>0.765959</td>
      <td>0.353324</td>
      <td>24.554054</td>
      <td>46.121622</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>Chase Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1946.000000</td>
      <td>2019.0</td>
      <td>1946.000000</td>
      <td>19596.0</td>
      <td>2.350492e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.377778</td>
      <td>...</td>
      <td>28.444444</td>
      <td>44.722222</td>
      <td>1.610613e+09</td>
      <td>112.833333</td>
      <td>0.461144</td>
      <td>0.782122</td>
      <td>0.374233</td>
      <td>25.377778</td>
      <td>43.900000</td>
      <td>0.511111</td>
    </tr>
    <tr>
      <th>Chesapeake Energy Arena</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1967.000000</td>
      <td>2019.0</td>
      <td>1967.000000</td>
      <td>19163.0</td>
      <td>2.171802e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.425000</td>
      <td>...</td>
      <td>23.450000</td>
      <td>45.387500</td>
      <td>1.610613e+09</td>
      <td>109.250000</td>
      <td>0.455088</td>
      <td>0.772437</td>
      <td>0.351600</td>
      <td>23.175000</td>
      <td>44.700000</td>
      <td>0.637500</td>
    </tr>
    <tr>
      <th>FedExForum</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1995.000000</td>
      <td>2019.0</td>
      <td>1995.000000</td>
      <td>18119.0</td>
      <td>2.131630e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.421053</td>
      <td>...</td>
      <td>25.394737</td>
      <td>44.578947</td>
      <td>1.610613e+09</td>
      <td>108.236842</td>
      <td>0.445092</td>
      <td>0.786355</td>
      <td>0.362816</td>
      <td>23.473684</td>
      <td>44.986842</td>
      <td>0.526316</td>
    </tr>
    <tr>
      <th>Fiserv Forum</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1968.000000</td>
      <td>2019.0</td>
      <td>1968.000000</td>
      <td>17500.0</td>
      <td>2.328482e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.385542</td>
      <td>...</td>
      <td>26.819277</td>
      <td>51.590361</td>
      <td>1.610613e+09</td>
      <td>106.421687</td>
      <td>0.417289</td>
      <td>0.758819</td>
      <td>0.347325</td>
      <td>23.253012</td>
      <td>44.385542</td>
      <td>0.843373</td>
    </tr>
    <tr>
      <th>Golden 1 Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1948.000000</td>
      <td>2019.0</td>
      <td>1948.000000</td>
      <td>17500.0</td>
      <td>2.142553e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.416667</td>
      <td>...</td>
      <td>24.125000</td>
      <td>45.208333</td>
      <td>1.610613e+09</td>
      <td>112.361111</td>
      <td>0.459417</td>
      <td>0.772444</td>
      <td>0.349514</td>
      <td>23.805556</td>
      <td>46.708333</td>
      <td>0.527778</td>
    </tr>
    <tr>
      <th>Little Caesars Arena</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1948.000000</td>
      <td>2019.0</td>
      <td>1948.000000</td>
      <td>21000.0</td>
      <td>2.171695e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.430380</td>
      <td>...</td>
      <td>23.974684</td>
      <td>44.670886</td>
      <td>1.610613e+09</td>
      <td>108.797468</td>
      <td>0.469127</td>
      <td>0.767203</td>
      <td>0.348127</td>
      <td>24.151899</td>
      <td>43.417722</td>
      <td>0.493671</td>
    </tr>
    <tr>
      <th>Madison Square Garden</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1946.000000</td>
      <td>2019.0</td>
      <td>1946.000000</td>
      <td>19763.0</td>
      <td>2.105316e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.421053</td>
      <td>...</td>
      <td>21.500000</td>
      <td>45.447368</td>
      <td>1.610613e+09</td>
      <td>112.105263</td>
      <td>0.463842</td>
      <td>0.756461</td>
      <td>0.365237</td>
      <td>24.263158</td>
      <td>45.263158</td>
      <td>0.250000</td>
    </tr>
    <tr>
      <th>Moda Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1970.000000</td>
      <td>2019.0</td>
      <td>1970.000000</td>
      <td>19980.0</td>
      <td>2.316313e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.373494</td>
      <td>...</td>
      <td>22.361446</td>
      <td>47.831325</td>
      <td>1.610613e+09</td>
      <td>112.060241</td>
      <td>0.448145</td>
      <td>0.793880</td>
      <td>0.371578</td>
      <td>22.939759</td>
      <td>44.048193</td>
      <td>0.662651</td>
    </tr>
    <tr>
      <th>Pepsi Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1976.000000</td>
      <td>2019.0</td>
      <td>1976.000000</td>
      <td>19099.0</td>
      <td>2.369186e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.395062</td>
      <td>...</td>
      <td>27.419753</td>
      <td>46.419753</td>
      <td>1.610613e+09</td>
      <td>103.777778</td>
      <td>0.448531</td>
      <td>0.742173</td>
      <td>0.323988</td>
      <td>23.320988</td>
      <td>42.172840</td>
      <td>0.790123</td>
    </tr>
    <tr>
      <th>Quicken Loans Arena</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1970.000000</td>
      <td>2019.0</td>
      <td>1970.000000</td>
      <td>20562.0</td>
      <td>2.132390e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.428571</td>
      <td>...</td>
      <td>22.038961</td>
      <td>44.025974</td>
      <td>1.610613e+09</td>
      <td>113.584416</td>
      <td>0.489766</td>
      <td>0.776896</td>
      <td>0.384247</td>
      <td>25.584416</td>
      <td>42.597403</td>
      <td>0.298701</td>
    </tr>
    <tr>
      <th>Scotiabank Arena</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1995.000000</td>
      <td>2019.0</td>
      <td>1995.000000</td>
      <td>19800.0</td>
      <td>2.428270e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.377778</td>
      <td>...</td>
      <td>25.433333</td>
      <td>45.100000</td>
      <td>1.610613e+09</td>
      <td>106.144444</td>
      <td>0.432111</td>
      <td>0.770211</td>
      <td>0.347544</td>
      <td>24.155556</td>
      <td>45.300000</td>
      <td>0.744444</td>
    </tr>
    <tr>
      <th>Smoothie King Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>2002.000000</td>
      <td>2019.0</td>
      <td>2002.000000</td>
      <td>NaN</td>
      <td>2.156903e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.424658</td>
      <td>...</td>
      <td>27.232877</td>
      <td>46.945205</td>
      <td>1.610613e+09</td>
      <td>116.808219</td>
      <td>0.474096</td>
      <td>0.771562</td>
      <td>0.362822</td>
      <td>25.109589</td>
      <td>44.561644</td>
      <td>0.438356</td>
    </tr>
    <tr>
      <th>Spectrum Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1988.000000</td>
      <td>2019.0</td>
      <td>1988.000000</td>
      <td>19026.0</td>
      <td>2.104182e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.413333</td>
      <td>...</td>
      <td>23.746667</td>
      <td>44.293333</td>
      <td>1.610613e+09</td>
      <td>109.386667</td>
      <td>0.463920</td>
      <td>0.761573</td>
      <td>0.350853</td>
      <td>25.066667</td>
      <td>45.266667</td>
      <td>0.493333</td>
    </tr>
    <tr>
      <th>Staples Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1959.210191</td>
      <td>2019.0</td>
      <td>1959.210191</td>
      <td>19060.0</td>
      <td>2.139604e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.414013</td>
      <td>...</td>
      <td>25.942675</td>
      <td>47.286624</td>
      <td>1.610613e+09</td>
      <td>110.477707</td>
      <td>0.443783</td>
      <td>0.775064</td>
      <td>0.338796</td>
      <td>24.095541</td>
      <td>45.133758</td>
      <td>0.636943</td>
    </tr>
    <tr>
      <th>State Farm Arena</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1949.000000</td>
      <td>2019.0</td>
      <td>1949.000000</td>
      <td>18729.0</td>
      <td>2.131766e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.434211</td>
      <td>...</td>
      <td>25.736842</td>
      <td>45.960526</td>
      <td>1.610613e+09</td>
      <td>117.894737</td>
      <td>0.463447</td>
      <td>0.767184</td>
      <td>0.343553</td>
      <td>25.500000</td>
      <td>46.276316</td>
      <td>0.421053</td>
    </tr>
    <tr>
      <th>TD Garden</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1946.000000</td>
      <td>2019.0</td>
      <td>1946.000000</td>
      <td>18624.0</td>
      <td>2.235308e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.397436</td>
      <td>...</td>
      <td>25.717949</td>
      <td>45.974359</td>
      <td>1.610613e+09</td>
      <td>106.358974</td>
      <td>0.442769</td>
      <td>0.743064</td>
      <td>0.335808</td>
      <td>23.282051</td>
      <td>44.153846</td>
      <td>0.717949</td>
    </tr>
    <tr>
      <th>Talking Stick Resort Arena</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1968.000000</td>
      <td>2019.0</td>
      <td>1968.000000</td>
      <td>NaN</td>
      <td>2.132518e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.441558</td>
      <td>...</td>
      <td>25.298701</td>
      <td>41.519481</td>
      <td>1.610613e+09</td>
      <td>113.064935</td>
      <td>0.474922</td>
      <td>0.762377</td>
      <td>0.363143</td>
      <td>24.285714</td>
      <td>45.000000</td>
      <td>0.311688</td>
    </tr>
    <tr>
      <th>Target Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1989.000000</td>
      <td>2019.0</td>
      <td>1989.000000</td>
      <td>19356.0</td>
      <td>2.156304e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.402778</td>
      <td>...</td>
      <td>24.458333</td>
      <td>46.583333</td>
      <td>1.610613e+09</td>
      <td>113.208333</td>
      <td>0.462306</td>
      <td>0.763181</td>
      <td>0.363625</td>
      <td>24.402778</td>
      <td>46.500000</td>
      <td>0.444444</td>
    </tr>
    <tr>
      <th>Toyota Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1967.000000</td>
      <td>2019.0</td>
      <td>1967.000000</td>
      <td>18104.0</td>
      <td>2.283925e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.387500</td>
      <td>...</td>
      <td>21.712500</td>
      <td>44.850000</td>
      <td>1.610613e+09</td>
      <td>110.275000</td>
      <td>0.454438</td>
      <td>0.759188</td>
      <td>0.339250</td>
      <td>24.200000</td>
      <td>45.700000</td>
      <td>0.737500</td>
    </tr>
    <tr>
      <th>United Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1966.000000</td>
      <td>2019.0</td>
      <td>1966.000000</td>
      <td>21711.0</td>
      <td>2.107486e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.435897</td>
      <td>...</td>
      <td>22.987179</td>
      <td>43.512821</td>
      <td>1.610613e+09</td>
      <td>110.705128</td>
      <td>0.475372</td>
      <td>0.750628</td>
      <td>0.355808</td>
      <td>25.602564</td>
      <td>46.192308</td>
      <td>0.307692</td>
    </tr>
    <tr>
      <th>Vivint Smart Home Arena</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1974.000000</td>
      <td>2019.0</td>
      <td>1974.000000</td>
      <td>20148.0</td>
      <td>2.197424e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.421053</td>
      <td>...</td>
      <td>24.526316</td>
      <td>47.592105</td>
      <td>1.610613e+09</td>
      <td>105.723684</td>
      <td>0.443618</td>
      <td>0.767803</td>
      <td>0.351961</td>
      <td>20.539474</td>
      <td>42.276316</td>
      <td>0.684211</td>
    </tr>
    <tr>
      <th>Wells Fargo Center</th>
      <td>0.0</td>
      <td>1.610613e+09</td>
      <td>1949.000000</td>
      <td>2019.0</td>
      <td>1949.000000</td>
      <td>NaN</td>
      <td>2.282764e+07</td>
      <td>1.610613e+09</td>
      <td>1.610613e+09</td>
      <td>2018.395062</td>
      <td>...</td>
      <td>27.395062</td>
      <td>47.617284</td>
      <td>1.610613e+09</td>
      <td>106.753086</td>
      <td>0.445346</td>
      <td>0.757247</td>
      <td>0.343272</td>
      <td>22.086420</td>
      <td>41.160494</td>
      <td>0.802469</td>
    </tr>
  </tbody>
</table>
<p>29 rows × 25 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="how-to-combine-the-same-data-for-different-outcomes">
<h2>How to combine the same data for different outcomes<a class="headerlink" href="#how-to-combine-the-same-data-for-different-outcomes" title="Permalink to this headline">¶</a></h2>
<p>We can combine datasets in different ways to learn different things about the data.
Let’s now read info about the players.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">players18</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/rhodyprog4ds/inclass-data/main/2018-players.csv&#39;</span><span class="p">)</span>
<span class="n">players19</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/rhodyprog4ds/inclass-data/main/2019-players.csv&#39;</span><span class="p">)</span>
<span class="n">players18</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>PLAYER_NAME</th>
      <th>TEAM_ID</th>
      <th>PLAYER_ID</th>
      <th>SEASON</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>626</td>
      <td>Kawhi Leonard</td>
      <td>1610612761</td>
      <td>202695</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>1</th>
      <td>627</td>
      <td>Pascal Siakam</td>
      <td>1610612761</td>
      <td>1627783</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>2</th>
      <td>628</td>
      <td>Marc Gasol</td>
      <td>1610612761</td>
      <td>201188</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>3</th>
      <td>629</td>
      <td>Danny Green</td>
      <td>1610612761</td>
      <td>201980</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>4</th>
      <td>630</td>
      <td>Kyle Lowry</td>
      <td>1610612761</td>
      <td>200768</td>
      <td>2018</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>First let’s look at the shape of each of them to have a reference for what happens when we try different merges.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">players18</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">players19</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((748, 5), (626, 5))
</pre></div>
</div>
</div>
</div>
<p>One thing we might want to do is to put all of the information into one long DataFrame. We can do this with <code class="docutils literal notranslate"><span class="pre">concat</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">players18</span><span class="p">,</span><span class="n">players19</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>PLAYER_NAME</th>
      <th>TEAM_ID</th>
      <th>PLAYER_ID</th>
      <th>SEASON</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>626</td>
      <td>Kawhi Leonard</td>
      <td>1610612761</td>
      <td>202695</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>1</th>
      <td>627</td>
      <td>Pascal Siakam</td>
      <td>1610612761</td>
      <td>1627783</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>2</th>
      <td>628</td>
      <td>Marc Gasol</td>
      <td>1610612761</td>
      <td>201188</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>3</th>
      <td>629</td>
      <td>Danny Green</td>
      <td>1610612761</td>
      <td>201980</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>4</th>
      <td>630</td>
      <td>Kyle Lowry</td>
      <td>1610612761</td>
      <td>200768</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>621</th>
      <td>621</td>
      <td>Anthony Bennett</td>
      <td>1610612745</td>
      <td>203461</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>622</th>
      <td>622</td>
      <td>Ray Spalding</td>
      <td>1610612737</td>
      <td>1629034</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>623</th>
      <td>623</td>
      <td>Devyn Marble</td>
      <td>1610612744</td>
      <td>203906</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>624</th>
      <td>624</td>
      <td>Hassani Gravett</td>
      <td>1610612753</td>
      <td>1629755</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>625</th>
      <td>625</td>
      <td>JaKeenan Gant</td>
      <td>1610612754</td>
      <td>1629721</td>
      <td>2019</td>
    </tr>
  </tbody>
</table>
<p>1374 rows × 5 columns</p>
</div></div></div>
</div>
<p>This allows us to see all the players for each year, we could do groupby and count to see how many players played each year for example.</p>
<p>We can check that this is the size we expected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">players18</span><span class="p">,</span><span class="n">players19</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1374, 5)
</pre></div>
</div>
</div>
</div>
<p>If we use the default merge settings we get an empty result because the two DataFrames have the same columns so pandas tries to merge <code class="docutils literal notranslate"><span class="pre">on</span></code> all of the columns, but there are no rows that have the same value in all of the columns, so there’s nothing left.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">players18</span><span class="p">,</span><span class="n">players19</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>PLAYER_NAME</th>
      <th>TEAM_ID</th>
      <th>PLAYER_ID</th>
      <th>SEASON</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we merge with on=’PLAYER_ID’, it only requires that one column to be the same to match rows from the two DataFrames together.  With the default value for <code class="docutils literal notranslate"><span class="pre">how</span></code> or explicitly setting <code class="docutils literal notranslate"><span class="pre">how='inner'</span></code> we get the info of players who played both seasons.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">players18</span><span class="p">,</span><span class="n">players19</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;PLAYER_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>PLAYER_NAME_x</th>
      <th>TEAM_ID_x</th>
      <th>PLAYER_ID</th>
      <th>SEASON_x</th>
      <th>Unnamed: 0_y</th>
      <th>PLAYER_NAME_y</th>
      <th>TEAM_ID_y</th>
      <th>SEASON_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>626</td>
      <td>Kawhi Leonard</td>
      <td>1610612761</td>
      <td>202695</td>
      <td>2018</td>
      <td>299</td>
      <td>Kawhi Leonard</td>
      <td>1610612746</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>1</th>
      <td>627</td>
      <td>Pascal Siakam</td>
      <td>1610612761</td>
      <td>1627783</td>
      <td>2018</td>
      <td>275</td>
      <td>Pascal Siakam</td>
      <td>1610612761</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>2</th>
      <td>628</td>
      <td>Marc Gasol</td>
      <td>1610612761</td>
      <td>201188</td>
      <td>2018</td>
      <td>276</td>
      <td>Marc Gasol</td>
      <td>1610612761</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1157</td>
      <td>Marc Gasol</td>
      <td>1610612763</td>
      <td>201188</td>
      <td>2018</td>
      <td>276</td>
      <td>Marc Gasol</td>
      <td>1610612761</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>4</th>
      <td>629</td>
      <td>Danny Green</td>
      <td>1610612761</td>
      <td>201980</td>
      <td>2018</td>
      <td>202</td>
      <td>Danny Green</td>
      <td>1610612747</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>533</th>
      <td>1339</td>
      <td>Abdul Gaddy</td>
      <td>1610612760</td>
      <td>203583</td>
      <td>2018</td>
      <td>561</td>
      <td>Abdul Gaddy</td>
      <td>1610612760</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>534</th>
      <td>1342</td>
      <td>Andre Roberson</td>
      <td>1610612760</td>
      <td>203460</td>
      <td>2018</td>
      <td>566</td>
      <td>Andre Roberson</td>
      <td>1610612760</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>535</th>
      <td>1348</td>
      <td>Norvel Pelle</td>
      <td>1610612755</td>
      <td>203658</td>
      <td>2018</td>
      <td>24</td>
      <td>Norvel Pelle</td>
      <td>1610612755</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>536</th>
      <td>1350</td>
      <td>Denzel Valentine</td>
      <td>1610612741</td>
      <td>1627756</td>
      <td>2018</td>
      <td>58</td>
      <td>Denzel Valentine</td>
      <td>1610612741</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>537</th>
      <td>1353</td>
      <td>C.J. Wilcox</td>
      <td>1610612754</td>
      <td>203912</td>
      <td>2018</td>
      <td>573</td>
      <td>C.J. Wilcox</td>
      <td>1610612754</td>
      <td>2019</td>
    </tr>
  </tbody>
</table>
<p>538 rows × 9 columns</p>
</div></div></div>
</div>
<p>When we use <code class="docutils literal notranslate"><span class="pre">outer</span></code> we get one row for each player who played in either season or both seasons.  From this we can for example see who changed teams, who are the rookies in 2019 and who retired or was unsigned in 2019.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">players18</span><span class="p">,</span><span class="n">players19</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;PLAYER_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>PLAYER_NAME_x</th>
      <th>TEAM_ID_x</th>
      <th>PLAYER_ID</th>
      <th>SEASON_x</th>
      <th>Unnamed: 0_y</th>
      <th>PLAYER_NAME_y</th>
      <th>TEAM_ID_y</th>
      <th>SEASON_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>626.0</td>
      <td>Kawhi Leonard</td>
      <td>1.610613e+09</td>
      <td>202695</td>
      <td>2018.0</td>
      <td>299.0</td>
      <td>Kawhi Leonard</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>627.0</td>
      <td>Pascal Siakam</td>
      <td>1.610613e+09</td>
      <td>1627783</td>
      <td>2018.0</td>
      <td>275.0</td>
      <td>Pascal Siakam</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>628.0</td>
      <td>Marc Gasol</td>
      <td>1.610613e+09</td>
      <td>201188</td>
      <td>2018.0</td>
      <td>276.0</td>
      <td>Marc Gasol</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1157.0</td>
      <td>Marc Gasol</td>
      <td>1.610613e+09</td>
      <td>201188</td>
      <td>2018.0</td>
      <td>276.0</td>
      <td>Marc Gasol</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>629.0</td>
      <td>Danny Green</td>
      <td>1.610613e+09</td>
      <td>201980</td>
      <td>2018.0</td>
      <td>202.0</td>
      <td>Danny Green</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>922</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1629097</td>
      <td>NaN</td>
      <td>619.0</td>
      <td>Terry Larrier</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>923</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>203461</td>
      <td>NaN</td>
      <td>621.0</td>
      <td>Anthony Bennett</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>924</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>203906</td>
      <td>NaN</td>
      <td>623.0</td>
      <td>Devyn Marble</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>925</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1629755</td>
      <td>NaN</td>
      <td>624.0</td>
      <td>Hassani Gravett</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>926</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1629721</td>
      <td>NaN</td>
      <td>625.0</td>
      <td>JaKeenan Gant</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
  </tbody>
</table>
<p>927 rows × 9 columns</p>
</div></div></div>
</div>
<p>Using  <code class="docutils literal notranslate"><span class="pre">left</span></code> gives us the <code class="docutils literal notranslate"><span class="pre">'PLAYER_ID'</span></code> that are in the left(<code class="docutils literal notranslate"><span class="pre">players18</span></code>) DataFrame, including those that are in both DataFrame
<code class="docutils literal notranslate"><span class="pre">right</span></code> would give players in the <code class="docutils literal notranslate"><span class="pre">players19</span></code> DataFrame or both DataFrames. With this result, we can see who retired, but not the 2019 rookies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">players18</span><span class="p">,</span><span class="n">players19</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;PLAYER_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>PLAYER_NAME_x</th>
      <th>TEAM_ID_x</th>
      <th>PLAYER_ID</th>
      <th>SEASON_x</th>
      <th>Unnamed: 0_y</th>
      <th>PLAYER_NAME_y</th>
      <th>TEAM_ID_y</th>
      <th>SEASON_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>626</td>
      <td>Kawhi Leonard</td>
      <td>1610612761</td>
      <td>202695</td>
      <td>2018</td>
      <td>299.0</td>
      <td>Kawhi Leonard</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>627</td>
      <td>Pascal Siakam</td>
      <td>1610612761</td>
      <td>1627783</td>
      <td>2018</td>
      <td>275.0</td>
      <td>Pascal Siakam</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>628</td>
      <td>Marc Gasol</td>
      <td>1610612761</td>
      <td>201188</td>
      <td>2018</td>
      <td>276.0</td>
      <td>Marc Gasol</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>629</td>
      <td>Danny Green</td>
      <td>1610612761</td>
      <td>201980</td>
      <td>2018</td>
      <td>202.0</td>
      <td>Danny Green</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>630</td>
      <td>Kyle Lowry</td>
      <td>1610612761</td>
      <td>200768</td>
      <td>2018</td>
      <td>451.0</td>
      <td>Kyle Lowry</td>
      <td>1.610613e+09</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>749</th>
      <td>1369</td>
      <td>Tyrius Walker</td>
      <td>1610612752</td>
      <td>1629246</td>
      <td>2018</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>750</th>
      <td>1370</td>
      <td>Marcus Lee</td>
      <td>1610612748</td>
      <td>1629159</td>
      <td>2018</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>751</th>
      <td>1371</td>
      <td>Trey Lewis</td>
      <td>1610612762</td>
      <td>1629163</td>
      <td>2018</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>752</th>
      <td>1372</td>
      <td>Emanuel Terry</td>
      <td>1610612743</td>
      <td>1629150</td>
      <td>2018</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>753</th>
      <td>1373</td>
      <td>Justin Bibbs</td>
      <td>1610612738</td>
      <td>1629167</td>
      <td>2018</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>754 rows × 9 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="try-it-yourself">
<h2>Try it yourself<a class="headerlink" href="#try-it-yourself" title="Permalink to this headline">¶</a></h2>
<p>Try different merges and inspect them:</p>
<ul class="simple">
<li><p>how many rows &amp; columns?</p></li>
<li><p>Where are NaN values inserted?</p></li>
<li><p>What rows from the original datasets are not included?</p></li>
<li><p>describe each type of merge in your own words</p></li>
</ul>
<p>Split a DataFrame into separate data frames by subsetting the columns and indexing the rows with <code class="docutils literal notranslate"><span class="pre">loc</span></code>, then use concat to put it back together. Programmatically check that it’s back together correctly.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="2020-10-02.html" title="previous page">Class 11: Cleaning Data</a>
    <a class='right-next' id="next-link" href="2020-10-07.html" title="next page">Class 13: Data from multiple sources and Databases</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Professor Sarah M Brown<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>